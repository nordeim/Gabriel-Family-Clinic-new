$ rm -rf .next/

$ npm run build

> gabriel-family-clinic@0.1.0 build
> next build

  ▲ Next.js 14.2.22
  - Environments: .env.local
  - Experiments (use with caution):
    · optimizeCss

   Creating an optimized production build ...
 ✓ Compiled successfully

./app/admin/security/dashboard/page.tsx
46:6  Warning: React Hook useEffect has a missing dependency: 'checkAdminAccess'. Either include it or remove the dependency array.  react-hooks/exhaustive-deps
52:6  Warning: React Hook useEffect has missing dependencies: 'loadSecurityData' and 'loading'. Either include them or remove the dependency array.  react-hooks/exhaustive-deps
106:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any

./app/auth/setup-2fa/page.tsx
22:36  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
26:6  Warning: React Hook useEffect has a missing dependency: 'checkAuth'. Either include it or remove the dependency array.  react-hooks/exhaustive-deps
65:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
106:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any

./app/patient/appointments/book/page.tsx
95:50  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any

./app/patient/security/page.tsx
37:6  Warning: React Hook useEffect has a missing dependency: 'loadSecurityData'. Either include it or remove the dependency array.  react-hooks/exhaustive-deps
71:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
99:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
132:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any

./components/data/card.tsx
99:34  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
168:3  Warning: Headings must have content and the content must be accessible by a screen reader.  jsx-a11y/heading-has-content

./components/feedback/alert.tsx
113:59  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
113:78  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
246:18  Warning: An interface declaring no members is equivalent to its supertype.  @typescript-eslint/no-empty-object-type
259:18  Warning: An interface declaring no members is equivalent to its supertype.  @typescript-eslint/no-empty-object-type

./components/forms/date-picker.tsx
255:11  Warning: The attribute aria-expanded is not supported by the role textbox. This role is implicit on the element input.  jsx-a11y/role-supports-aria-props
356:21  Warning: The attribute aria-selected is not supported by the role button. This role is implicit on the element button.  jsx-a11y/role-supports-aria-props

./components/overlay/modal.tsx
155:5  Warning: Visible, non-interactive elements with click handlers must have at least one keyboard listener.  jsx-a11y/click-events-have-key-events
155:5  Warning: Non-interactive elements should not be assigned mouse or keyboard event listeners.  jsx-a11y/no-noninteractive-element-interactions

./lib/healthcare/chas-utils.ts
209:45  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any

./lib/polyfills.ts
5:16  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any

./lib/seo/structured-data.tsx
6:18  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any

./lib/supabase/auth.ts
69:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
116:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
135:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
156:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
177:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
215:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
238:19  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any

./lib/supabase/server.ts
85:51  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
88:39  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any

./lib/utils.ts
85:46  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any
85:56  Warning: Unexpected any. Specify a different type.  @typescript-eslint/no-explicit-any

info  - Need to disable some ESLint rules? Learn more here: https://nextjs.org/docs/basic-features/eslint#disabling-rules
 ✓ Linting and checking validity of types    
   Collecting page data  ...ReferenceError: self is not defined
    at Object.<anonymous> (/home/project/Gabriel-Family-Clinic-new/.next/server/components.js:1:14)
    at Module._compile (node:internal/modules/cjs/loader:1730:14)
    at Object..js (node:internal/modules/cjs/loader:1895:10)
    at Module.load (node:internal/modules/cjs/loader:1465:32)
    at Function._load (node:internal/modules/cjs/loader:1282:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)
    at Module.<anonymous> (node:internal/modules/cjs/loader:1487:12)
    at mod.require (/home/project/Gabriel-Family-Clinic-new/node_modules/next/dist/server/require-hook.js:65:28)
    at require (node:internal/modules/helpers:135:16)

> Build error occurred
Error: Failed to collect page data for /favicon.ico
    at /home/project/Gabriel-Family-Clinic-new/node_modules/next/dist/build/utils.js:1269:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  type: 'Error'
}

$ npm list @supabase/ssr
gabriel-family-clinic@0.1.0 /home/project/Gabriel-Family-Clinic-new
└── @supabase/ssr@0.5.0


$ cat instrumentation.ts 
/**
 * Instrumentation file for Next.js
 * Provides polyfills for server-side rendering
 */

export function register() {
  // Polyfill 'self' for Node.js environment
  try {
    if (typeof (global as any).self === 'undefined') {
      (global as any).self = global;
    }
  } catch (e) {
    // Gracefully handle if 'self' check fails
    (global as any).self = global;
  }
  
  // Polyfill 'window' for Node.js environment
  try {
    if (typeof (global as any).window === 'undefined') {
      (global as any).window = global;
    }
  } catch (e) {
    (global as any).window = global;
  }
  
  // Polyfill 'document' for Node.js environment
  try {
    if (typeof (global as any).document === 'undefined') {
      (global as any).document = {
        querySelector: function() { return null; },
        querySelectorAll: function() { return []; },
        getElementById: function() { return null; },
        getElementsByClassName: function() { return []; },
        getElementsByTagName: function() { return []; },
        createElement: function() { 
          return {
            setAttribute: function() {},
            getAttribute: function() { return null; },
            style: {},
            appendChild: function() {},
            removeChild: function() {},
          };
        },
        createTextNode: function() { return {}; },
        head: {
          appendChild: function() {},
          removeChild: function() {},
        },
        body: {
          appendChild: function() {},
          removeChild: function() {},
        },
      };
    }
  } catch (e) {
    // Basic document polyfill
    (global as any).document = {};
  }
}
